<!DOCTYPE html>
<html lang="en" style="background-color: white;">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
		<meta name="format-detection" content="telephone=no">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<link rel="icon" href="" />
		<title>复仇的小猪账号注册</title>
		<meta name="keywords" content="对战版愤怒的小鸟">
		<meta name="description" content="愤怒的小鸟对战版">
		<link rel="stylesheet" type="text/css" href="css/AngryBirds.css?2">
		<script type="text/javascript" src="js/flexible.js"></script>
		<script src="https://cdn.dingxiang-inc.com/ctu-group/captcha-ui/index.js"></script>
		<link rel="stylesheet" href="css/bootstrap.min.css">
	</head>
	<style>
		#cnzz_stat_icon_1270505203 {
			display: none;
		}
		
		input::-webkit-input-placeholder {
			/*WebKit browsers*/
			color: rgb(204, 204, 204);
			line-height: 0.56rem;
			font-size: 0.28rem;
		}
		
		input::-moz-input-placeholder {
			/*Mozilla Firefox*/
			color: rgb(204, 204, 204);
			line-height: 0.56rem;
			font-size: 0.28rem;
		}
		
		input::-ms-input-placeholder {
			/*Internet Explorer*/
			color: rgb(204, 204, 204);
			line-height: 0.56rem;
			font-size: 0.28rem;
		}
	</style>

	<body>

		<div class="wrap" id="app">
			<div class="header2 clearfix" style="color: white;background-color: #080808;">
				<div class="fl sanjiao glyphicon glyphicon-chevron-left" onclick="back()"></div>
				<div class="head_txt" style="color: white;">账号注册&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
			</div>
			<img style="width: 100%;" src="images/zc1.png" />
			<img style="width: 7.79rem;height: 0.43rem;margin-left: 1.11rem;margin-top: 0.46rem;" src="images/zc2.png" />

			<div style="width: 7.84rem;height: 1.15rem;margin-left: 1.08rem;margin-top: 0.86rem;border: 1px solid rgb(204, 204, 204);border-radius: 1rem;">
				<img style="width: 0.31rem;height: 0.46rem;float: left;margin-left: 0.51rem;margin-top: 0.35rem;" src="images/zc3.png" />
				<input style="float: left;border: 0;border-left: 0.03rem solid rgb(204, 204, 204);margin-left: 0.28rem;height: 0.56rem;margin-top: 0.3rem;width: 5.64rem;padding-left: 0.31rem;font-size: 0.28rem;color: #535376;line-height: 0.56rem;border-radius: 0;" placeholder="请输入手机号" type="tel" id="phone" />
			</div>
			<div style="width: 7.84rem;height: 1.15rem;margin-left: 1.08rem;margin-top: 0.46rem;border: 1px solid rgb(204, 204, 204);border-radius: 1rem;">
				<img style="width: 0.32rem;height: 0.46rem;float: left;margin-left: 0.51rem;margin-top: 0.31rem;" src="images/zc4.png" />
				<input style="float: left;border: 0;border-left: 0.03rem solid rgb(204, 204, 204);margin-left: 0.27rem;height: 0.56rem;margin-top: 0.3rem;width: 5.64rem;padding-left: 0.31rem;font-size: 0.28rem;color: #535376;line-height: 0.56rem;border-radius: 0;" placeholder="请输入密码" type="password" id="password" />
			</div>
			<div style="width: 7.84rem;height: 1.15rem;margin-left: 1.08rem;margin-top: 0.46rem;border: 1px solid rgb(204, 204, 204);border-radius: 1rem;">
				<img style="width: 0.32rem;height: 0.35rem;float: left;margin-left: 0.51rem;margin-top: 0.4rem;" src="images/zc5.png" />
				<input style="float: left;border: 0;border-left: 0.03rem solid rgb(204, 204, 204);margin-left: 0.27rem;height: 0.56rem;margin-top: 0.3rem;width: 5.64rem;padding-left: 0.31rem;font-size: 0.28rem;color: #535376;line-height: 0.56rem;border-radius: 0;" placeholder="imToken地址(选填)" type="text" id="address" />
			</div>
			<div style="width: 7.84rem;height: 1.15rem;margin-left: 1.08rem;margin-top: 0.46rem;border: 1px solid rgb(204, 204, 204);border-radius: 1rem;">
				<img style="width: 0.38rem;height: 0.4rem;float: left;margin-left: 0.46rem;margin-top: 0.38rem;" src="images/zc6.png" />
				<input style="float: left;border: 0;border-left: 0.03rem solid rgb(204, 204, 204);margin-left: 0.27rem;height: 0.56rem;margin-top: 0.3rem;width: 5.64rem;padding-left: 0.31rem;font-size: 0.28rem;color: #535376;line-height: 0.56rem;border-radius: 0;" placeholder="邀请码(选填)" type="text" id="inviteCode" />
			</div>
			<div style="margin-left: 0.4rem;margin-top: 0.5rem;" id="c1"></div>
			<img onclick="register()" style="height: 1.52rem;width: 8.08rem;margin-top: 0.5rem;margin-left: 0.96rem;" src="images/zc7.png" />
			<img onclick="agreement()" style="width: 3.56rem;height: 0.76rem;margin-top: 0.31rem;margin-left: 3.22rem;" src="images/zc8.png" />
			<div style="width: 8.48rem;height: 9.28rem;border-radius: 0.3rem;margin-top: 0.67rem;margin-left: 0.76rem;background-color: #5DA615;">
				<img style="width: 3.7rem;padding-top: 0.82rem;margin-left: 2.4rem;height: 4.54rem;" src="images/zc9.png" />
				<img style="width: 3.55rem;height: 3.55rem;margin-top: 0.36rem;margin-left: 2.47rem;" src="images/zc10.png" />
			</div>
			<img style="width: 100%;" src="images/zc11.png" />
		</div>
		<script src="https://code.jquery.com/jquery-3.2.1.min.js "></script>
		<script src="js/base/util.js"></script>
		<script src="js/base/url.js"></script>
		<script src="js/base/base_net.js"></script>
		<script src="js/gVerify.js"></script>
	</body>
	<script src="js/bootstrap.min.js"></script>
	<script>
		var is_code = true;
		var isback = true;
		var uid = '';
		var tk = '';
		$(document).ready(function() {
			var info_id = getUrlParam("info_id");
			$("#inviteCode").val(info_id);
		})

		function register() {
			if(isback == false) {
				return;
			}

			var phone = $("#phone").val()
			var password = $("#password").val()
			//			var email = $("#email").val()
			//			var weixin = $("#weixin").val()
			var inviteCode = $("#inviteCode").val()
			//			var name = $("#name").val()
			var address = $("#address").val()

			if(phone == '' || phone == null || phone == 'null') {
				alert("手机号不能为空")
				return
			}
			if(!(/^1[0-9][0-9]\d{4,8}$/.test(phone))) {
				alert("不是完整的11位手机号或者正确的手机号前七位");
				return false;
			}
			if(inviteCode == '' || inviteCode == null || inviteCode == 'null') {
				alert("邮箱不能为空")
				return
			}

			//			if(email == '' || email == null || email == 'null') {
			//				alert("邮箱不能为空")
			//				return
			//			}
			//
			//			if(weixin == '' || weixin == null || weixin == 'null') {
			//				alert("微信号不能为空")
			//				return
			//			}
			//			if(name == '' || name == null || name == 'null') {
			//				alert("姓名不能为空")
			//				return
			//			}

			if(password.length < 6) {
				alert("密码至少6位！")
				return
			} else if(password == '' || password == null || password == 'null') {
				alert("密码不能为空！")
				return
			}
			//			if(address == '' || address == null || address == 'null') {
			//				alert("地址不能为空")
			//				return
			//			}
			if(tk == '') {
				alert("请先完成智能验证")
				return
			}
			isback = false;
			req(USER_IPG_REGISTER_URL, {
				'phone': phone,
				'password': password,
				//				'email': email,
				//				'weixin': weixin,
				'inviteCode': inviteCode,
				//				'username': name,
				'address': address,
				'token': tk
			}, function(data) {

				alert("注册成功！请记住密码：" + password)
				uid = data.user.uid
				setItem("pigUID", uid)
				setLocal("pigUID", uid)
				setLocal("pigphone", phone)
				setItem("pigphone", phone)
				isback = true;
				window.location = 'index.html'

			}, function(err) {
				isback = true;
				console.log(err.msg)
				alert(err.msg)
			})

		}

		function back() {
			history.go(-1)
		}

		function getUrlParam(name) {
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
			var r = window.location.search.substr(1).match(reg); //匹配目标参数
			if(r != null) return unescape(r[2]);
			return null; //返回参数值
		}

		var myCaptcha = _dx.Captcha(document.getElementById('c1'), {
			appId: 'ccd387e44f717b10b6edf16c83261cb0', //appId,开通服务后可在控制台中“服务管理”模块获取
			style: 'embed',
			width: 300,
			success: function(token) {
				console.log('token:', token)
				tk = token
			},
			fail: function(e) {
				console.log(e)
				alert("验证失败，请重试")
				myCaptcha.reload()
			}
		})

		function agreement() {
			window.location = 'agreementText.html'
		}
	</script>

</html>