<!DOCTYPE html>
<html lang="en" style="">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
		<meta name="format-detection" content="telephone=no">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<link rel="icon" href="" />
		<title>StikPanda</title>
		<link rel="stylesheet" type="text/css" href="../css/AngryBirds.css?2">
		<script type="text/javascript" src="../js/flexible.js"></script>
		<link rel="stylesheet" href="../css/bootstrap.min.css">
		<script src="../js/jquery-2.1.4.min.js"></script>
	</head>
	<style>
		#cnzz_stat_icon_1270505203 {
			display: none;
		}
		
		input::-webkit-input-placeholder {
			/*WebKit browsers*/
			color: white;
			line-height: 0.56rem;
			font-size: 0.28rem;
			background-color: rgba(0, 0, 0, 0);
		}
		
		input::-moz-input-placeholder {
			/*Mozilla Firefox*/
			color: white;
			line-height: 0.56rem;
			font-size: 0.28rem;
			background-color: rgba(0, 0, 0, 0);
		}
		
		input::-ms-input-placeholder {
			/*Internet Explorer*/
			color: white;
			line-height: 0.56rem;
			font-size: 0.28rem;
			background-color: rgba(0, 0, 0, 0);
		}
	</style>

	<body style="background:url(images/indexbg.jpg) no-repeat;background-size: 100% 100%; height: 18rem;">

		<div class="wrap" id="app">

			<div style="background:url(images/indexipg.png) no-repeat;background-size: 100% 100%;width: 5rem;height: 1.6rem;margin-left: 2.4rem;margin-top: 6rem;">
				<div style="height: 0.9rem;margin-top: 0.4rem;width: 2.5rem;font-size: 0.5rem;color: white;line-height: 0.9rem;margin-left: 1.9rem;position: absolute;" id="ipgs">X0</div>
			</div>
			<div style="height: 0.4rem;"></div>
			<div style="background:url(images/indexchose.png) no-repeat;background-size: 100% 100%;width: 5rem;height: 1.6rem;margin-left: 2.4rem;">
				<img id="coins100" onclick="chose(1)" style="width: 30%;float: left;margin-left: 2%;margin-top: 0.06rem;" src="images/100coinn.png" />
				<img id="coins500" onclick="chose(5)" style="width: 30%;float: left;margin-left: 36%;margin-top: 0.06rem;" src="images/500coinn.png" />
			</div>

			<div style="height: 0.2rem;clear: both;"></div>
			<div style="text-align: center;font-weight: bold;"><span style="color: #ff7600;">5</span>IPG结算X1、<span style="color: #ff7600;">50</span>IPG结算X5</div>
			<div style="height: 0.4rem;clear: both;"></div>
			<img id="startbutton" onclick="start()" style="width: 22%;margin-left: 39%;" src="images/indexstartn.png" />
			<div style="height: 0.4rem;"></div>
			<div style="background:url(images/indexlist.png) no-repeat;background-size: 100% 100%; height: 3rem;margin: auto;width: 7rem;">
				<div style="height: 0.9rem;"></div>
				<div style="color: white;width: 6rem;margin-left: 1.2rem;"><span style="float: left;" id="phone0"></span><span style="float: left;margin-left: 0.2rem;">最高積分</span><span style="float: left;margin-left: 0.2rem;color: #fff900;" id="score0"></span></div>
				<div style="clear: both;height: 0.1rem;"></div>
				<div style="color: white;width: 6rem;margin-left: 1.2rem;"><span style="float: left;" id="phone1"></span><span style="float: left;margin-left: 0.2rem;">最高積分</span><span style="float: left;margin-left: 0.2rem;color: #fff900;" id="score1"></span></div>
				<div style="clear: both;height: 0.1rem;"></div>
				<div style="color: white;width: 6rem;margin-left: 1.2rem;"><span style="float: left;" id="phone2"></span><span style="float: left;margin-left: 0.2rem;">最高積分</span><span style="float: left;margin-left: 0.2rem;color: #fff900;" id="score2"></span></div>
			</div>
		</div>
		<script src="https://code.jquery.com/jquery-3.2.1.min.js "></script>
		<script src="../js/base/util.js"></script>
		<script src="../js/base/url.js"></script>
		<script src="../js/base/base_net.js"></script>
		<script src="../js/gVerify.js"></script>
	</body>
	<script src="../js/bootstrap.min.js"></script>
	<script>
		var coin = 0;
		var name = '';
		var uid = "";
		var phone = "";
		var moneyi = 0;
		var isback = true;
		var cashc = 0;
		uid = getLocal("pigUID");
		phone = getLocal("pigphone");
		$(document).ready(function() {
			if(uid && uid != null && uid != "null") {

			} else {
				window.location.href = "login.html";
			}
			req(IPG_USER_MONEY_QUERY, {
					'uid': uid
				}, function(data) {
					var dat = data.userMoney;
					var money = dat.money;
					moneyi = money
					$("#ipgs").text("X" + money)
					req(IPG_GAME_LIST, {
							'game_name': "StikPanda"
						}, function(data) {
							var dat = data.game_list;
							var len = dat.length;
							for(var i = 0; i < len; i++) {
								for(var j = i + 1; j < len; j++) {
									if(dat[i].phone == dat[j].phone) {
										dat.splice(j, 1)
										len = len -1;
										j = j-1;
									}
								}
							}
							console.log(data)

							for(var s = 0; s < 3; s++) {
								$("#phone" + s).text(dat[s].phone.substr(0, 3) + "****" + dat[s].phone.substr(7, 11))
								$("#score" + s).text(dat[s].score)
							}
						},
						function(e) {
							alert("獲取用戶信息失敗，請刷新頁面重試")
						})
				},
				function(e) {
					alert("獲取用戶信息失敗，請刷新頁面重試")
				})
		})

		function chose(x) {
			if(moneyi < x) {
				alert("您沒有那麽多籌碼")
				return
			}
			if(x == 1) {
				cashc = 5
				$("#coins100").attr("src", "images/100coiny.png")
				$("#coins500").attr("src", "images/500coinn.png")
			}
			if(x == 5) {
				cashc = 20
				$("#coins100").attr("src", "images/100coinn.png")
				$("#coins500").attr("src", "images/500coiny.png")
			}
			$("#startbutton").attr("src", "images/indexstarty.png")
			coin = x;
		}

		function start() {
			if(isback == false) {
				return;
			}
			if(coin == 0) {
				alert("請先選擇籌碼！")
				return
			}
			if(uid && uid != null && uid != "null") {

			} else {
				alert("請先登錄")
				window.location.href = "login.html";
				return
			}
			if(moneyi < coin) {
				alert("您沒有那麽多籌碼")
				return
			}
			isback = false
			req(IPG_GAME_CASH, {
					'uid': uid,
					'game_cash_money1': cashc,
					'game_name': 'StikPanda'
				}, function(data) {
					isback = true;
					window.location.href = "game.html?coin=" + coin;
				},
				function(e) {
					isback = true;
					alert(e.msg)
					window.location.href = "game.html?coin=" + coin;
				})

		}

		function getUrlParam(name) {
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
			var r = window.location.search.substr(1).match(reg); //匹配目标参数
			if(r != null) return unescape(r[2]);
			return null; //返回参数值
		}
	</script>

</html>